# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»ã‚¯ãƒ©ã‚¹è©³ç´°è¨­è¨ˆ

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ TypeScript ãƒ™ãƒ¼ã‚¹ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆã§ã€å‹å®‰å…¨æ€§ã¨ä¿å®ˆæ€§ã‚’é‡è¦–ã—ãŸè¨­è¨ˆã¨ãªã£ã¦ã„ã¾ã™ã€‚å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è©³ç´°è¨­è¨ˆã¯å€‹åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚

## ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ

### ğŸ“ **src/core/** - ã‚³ã‚¢ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯

#### 1. [TriggerManager](./è©³ç´°è¨­è¨ˆ/TriggerManagerè©³ç´°è¨­è¨ˆ.md) ğŸ”§
- **å½¹å‰²**: ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³è¨­è¨ˆã«ã‚ˆã‚‹ãƒˆãƒªã‚¬ãƒ¼ç®¡ç†ãƒ»ãƒ¡ã‚¤ãƒ³åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼
- **è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³**: Singleton Pattern
- **ä¸»è¦æ©Ÿèƒ½**: 
  - onEdit / onEditInstallable ãƒˆãƒªã‚¬ãƒ¼å‡¦ç†
  - ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆåˆ¶å¾¡ãƒ»çŠ¶æ…‹ç®¡ç†
  - ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ãƒˆãƒªã‚¬ãƒ¼ç®¡ç†
  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½

#### 2. [ConfigManager](./è©³ç´°è¨­è¨ˆ/ConfigManagerè©³ç´°è¨­è¨ˆ.md) âš™ï¸
- **å½¹å‰²**: é™çš„ã‚¯ãƒ©ã‚¹è¨­è¨ˆã«ã‚ˆã‚‹è¨­å®šãƒ»èªè¨¼æƒ…å ±ç®¡ç†
- **è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³**: Static Class with Caching
- **ä¸»è¦æ©Ÿèƒ½**:
  - ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆè¨­å®šèª­ã¿è¾¼ã¿ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  - ã‚»ã‚­ãƒ¥ã‚¢ãªAPIèªè¨¼æƒ…å ±ç®¡ç†
  - ã‚«ãƒ©ãƒ ãƒãƒƒãƒ”ãƒ³ã‚°è¨­å®šãƒ»æ¤œè¨¼
  - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãƒ»è¨ºæ–­æ©Ÿèƒ½

#### 3. [DataMapper](./è©³ç´°è¨­è¨ˆ/DataMapperè©³ç´°è¨­è¨ˆ.md) ğŸ”„
- **å½¹å‰²**: ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ»ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ»æ¤œè¨¼é€£æº
- **è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³**: Static Class with Validation
- **ä¸»è¦æ©Ÿèƒ½**:
  - TypeScriptå‹å®‰å…¨ãªãƒ‡ãƒ¼ã‚¿å¤‰æ›
  - Notion APIå½¢å¼ã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°
  - Validatoré€£æºã«ã‚ˆã‚‹æ¤œè¨¼
  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

#### 4. [NotionApiClient](./è©³ç´°è¨­è¨ˆ/NotionApiClientè©³ç´°è¨­è¨ˆ.md) ğŸŒ
- **å½¹å‰²**: Notion APIé€šä¿¡ãƒ»æ¥ç¶šç®¡ç†
- **è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³**: Instance Class with Rate Limiting
- **ä¸»è¦æ©Ÿèƒ½**:
  - ãƒšãƒ¼ã‚¸ä½œæˆãƒ»æ›´æ–°ãƒ»å–å¾—
  - ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾å¿œï¼ˆ3req/sï¼‰
  - æ¥ç¶šãƒ†ã‚¹ãƒˆãƒ»ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
  - è©³ç´°ãªAPI ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

#### 5. [Validator](./è©³ç´°è¨­è¨ˆ/Validatorè©³ç´°è¨­è¨ˆ.md) âœ…
- **å½¹å‰²**: TypeScriptå‹ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
- **è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³**: Static Class with Type Guards
- **ä¸»è¦æ©Ÿèƒ½**:
  - è¡Œãƒ‡ãƒ¼ã‚¿å½¢å¼ãƒã‚§ãƒƒã‚¯
  - ã‚«ãƒ©ãƒ ãƒãƒƒãƒ”ãƒ³ã‚°æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
  - Notionãƒ—ãƒ­ãƒ‘ãƒ†ã‚£äº’æ›æ€§æ¤œè¨¼
  - è©³ç´°ãªã‚¨ãƒ©ãƒ¼åˆ†é¡ãƒ»å ±å‘Š

### ğŸ“ **src/utils/** - ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ»ã‚¤ãƒ³ãƒ•ãƒ©

#### 6. **Logger** ğŸ“
- **å½¹å‰²**: é«˜æ©Ÿèƒ½ãƒ­ã‚°ãƒ»ãƒã‚¹ã‚­ãƒ³ã‚°ãƒ»ã‚¿ã‚¤ãƒãƒ¼æ©Ÿèƒ½
- **è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³**: Static Class with Sensitive Data Protection
- **ä¸»è¦æ©Ÿèƒ½**:
  - æ§‹é€ åŒ–ãƒ­ã‚°å‡ºåŠ›ï¼ˆDEBUG/INFO/WARN/ERRORï¼‰
  - æ©Ÿå¯†æƒ…å ±ã®è‡ªå‹•ãƒã‚¹ã‚­ãƒ³ã‚°
  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ã‚¿ã‚¤ãƒãƒ¼
  - ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›å¯¾å¿œ

#### 7. **Constants** ğŸ›ï¸
- **å½¹å‰²**: ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®å®šæ•°ãƒ»è¨­å®šå€¤ç®¡ç†
- **ä¸»è¦æ©Ÿèƒ½**:
  - ã‚·ãƒ¼ãƒˆåãƒ»ã‚«ãƒ©ãƒ ä½ç½®å®šæ•°
  - Notion APIè¨­å®šå€¤
  - ãƒ‡ãƒ¼ã‚¿å‹ãƒãƒƒãƒ”ãƒ³ã‚°å®šç¾©
  - ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä½“ç³»

### ğŸ“ **src/types/** - å‹å®šç¾©

#### 8. **å‹å®šç¾©ã‚·ã‚¹ãƒ†ãƒ ** ğŸ“‹
- **å½¹å‰²**: TypeScriptå‹å®‰å…¨æ€§ä¿è¨¼
- **ä¸»è¦è¦ç´ **:
  - ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©ï¼ˆSystemConfig, ColumnMappingç­‰ï¼‰
  - ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ä½“ç³»
  - Notion APIãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹
  - åˆ—æŒ™å‹ï¼ˆErrorType, LogLevelç­‰ï¼‰

### ğŸ“ **src/** - ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ

#### 9. **index.ts** ğŸšª
- **å½¹å‰²**: Google Apps Scriptç”¨ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
- **ä¸»è¦æ©Ÿèƒ½**:
  - ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°å®šç¾©
  - ãƒ‡ãƒãƒƒã‚°ãƒ»è¨ºæ–­é–¢æ•°ç¾¤
  - ãƒˆãƒªã‚¬ãƒ¼ç®¡ç†é–¢æ•°
  - æ‰‹å‹•ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£é–¢ä¿‚å›³

```
ğŸ“ src/index.ts (Entry Point)
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TriggerManager â”‚ â† ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ»åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼ãƒ»çŠ¶æ…‹ç®¡ç†
â”‚   (Singleton)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   â”‚  ConfigManager  â”‚ â† é™çš„ã‚¯ãƒ©ã‚¹ãƒ»è¨­å®šç®¡ç†ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥
         â”‚   â”‚  (Static+Cache) â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   â”‚   DataMapper    â”‚ â† é™çš„ã‚¯ãƒ©ã‚¹ãƒ»ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ»æ¤œè¨¼é€£æº
         â”‚   â”‚    (Static)     â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚            â”‚
         â”‚            â–¼
         â”œâ”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   â”‚    Validator    â”‚ â† é™çš„ã‚¯ãƒ©ã‚¹ãƒ»å‹ã‚¬ãƒ¼ãƒ‰ãƒ»æ¤œè¨¼
         â”‚   â”‚    (Static)     â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   â”‚ NotionApiClient â”‚ â† ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ»APIé€šä¿¡ãƒ»ãƒ¬ãƒ¼ãƒˆåˆ¶é™
         â”‚   â”‚   (Instance)    â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚     Logger      â”‚ â† é™çš„ã‚¯ãƒ©ã‚¹ãƒ»ãƒ­ã‚°ãƒ»ãƒã‚¹ã‚­ãƒ³ã‚°ãƒ»ã‚¿ã‚¤ãƒãƒ¼
             â”‚  (Static+Utils) â”‚ â† ï¼ˆå…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰åˆ©ç”¨ï¼‰
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚   Constants     â”‚ â† å®šæ•°ãƒ»è¨­å®šå€¤ãƒ»å‹å®šç¾©
             â”‚   (Static)      â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³é©ç”¨çŠ¶æ³

| ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ | ç†ç”±ãƒ»åˆ©ç‚¹ |
|-----------|----------------|-----------|
| TriggerManager | Singleton | GASç’°å¢ƒã§ã®çŠ¶æ…‹ç®¡ç†ãƒ»é‡è¤‡å®Ÿè¡Œé˜²æ­¢ |
| ConfigManager | Static Class + Caching | è¨­å®šã®ä¸€å…ƒç®¡ç†ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š |
| DataMapper | Static Class | ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ãªå¤‰æ›å‡¦ç†ãƒ»ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ |
| Validator | Static Class + Type Guards | å‹å®‰å…¨æ€§ãƒ»ç´”ç²‹é–¢æ•°çš„è¨­è¨ˆ |
| NotionApiClient | Instance Class | APIçŠ¶æ…‹ç®¡ç†ãƒ»ãƒ¬ãƒ¼ãƒˆåˆ¶é™åˆ¶å¾¡ |
| Logger | Static Class + Strategy | æ¨ªæ–­çš„é–¢å¿ƒäº‹ãƒ»ãƒ—ãƒ©ã‚¬ãƒ–ãƒ«å‡ºåŠ› |

## å…±é€šãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã§ä½¿ç”¨ã•ã‚Œã‚‹ TypeScript ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

```typescript
// ğŸ“‹ ã‚·ã‚¹ãƒ†ãƒ è¨­å®š
interface SystemConfig {
  databaseId: string;
  projectName: string;
  version: string;
  apiToken: string;
  batchSize?: number;
  autoSyncEnabled?: boolean;
  retryAttempts?: number;
  retryDelay?: number;
  webhookUrl?: string;
}

// ğŸ“‹ ã‚«ãƒ©ãƒ ãƒãƒƒãƒ”ãƒ³ã‚°
interface ColumnMapping {
  spreadsheetColumn: string;
  notionPropertyName: string;
  dataType: string;
  isTarget: boolean;
  isRequired: boolean;
}

// ğŸ“‹ Notionãƒšãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿
interface NotionPageData {
  properties: Record<string, NotionProperty>;
  children?: any[]; // ãƒšãƒ¼ã‚¸å†…ã®ãƒ–ãƒ­ãƒƒã‚¯è¦ç´ ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
}

// ğŸ“‹ å‹å®‰å…¨ãªNotionãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
type NotionProperty =
  | { type: 'title'; title: Array<{ text: { content: string } }> }
  | { type: 'rich_text'; rich_text: Array<{ text: { content: string } }> }
  | { type: 'number'; number: number | null }
  | { type: 'select'; select: { name: string } | null }
  | { type: 'multi_select'; multi_select: Array<{ name: string }> }
  | { type: 'date'; date: { start: string; end?: string } | null }
  | { type: 'checkbox'; checkbox: boolean }
  | { type: 'url'; url: string | null }
  | { type: 'email'; email: string | null }
  | { type: 'phone_number'; phone_number: string | null };

// ğŸ“‹ æ¤œè¨¼çµæœ
interface ValidationResult {
  valid: boolean;
  errors: string[];
}

// ğŸ“‹ ã‚¤ãƒ³ãƒãƒ¼ãƒˆçµæœ
interface ImportResult {
  success: boolean;
  result?: NotionPageResponse;
  error?: Error;
}

// ğŸ“‹ å‡¦ç†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
interface ProcessingStatus {
  isProcessing: boolean;
  lastProcessTime: number;
  errorHistory: Array<{
    timestamp: Date;
    error: string;
    context?: any;
  }>;
}
```

### ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ä½“ç³»

```typescript
// ğŸ“‹ åŸºåº•ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹
export class SpreadsheetToNotionError extends Error {
  constructor(
    message: string,
    public readonly type: ErrorType,
    public readonly originalError?: Error
  ) { super(message); }
}

// ğŸ“‹ å…·ä½“çš„ãªã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹
export class ConfigError extends SpreadsheetToNotionError { ... }
export class ValidationError extends SpreadsheetToNotionError { ... }
export class MappingError extends Error { ... }
export class ApiError extends SpreadsheetToNotionError { ... }

// ğŸ“‹ ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—åˆ—æŒ™
export enum ErrorType {
  CONFIG_ERROR = 'CONFIG_ERROR',
  VALIDATION_ERROR = 'VALIDATION_ERROR',
  API_ERROR = 'API_ERROR',
  NETWORK_ERROR = 'NETWORK_ERROR',
  PERMISSION_ERROR = 'PERMISSION_ERROR',
}
```

## é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### ğŸ§ª ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆæ§‹æˆ

#### **å˜ä½“ãƒ†ã‚¹ãƒˆ** (`test/unit/`)
å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ç‹¬ç«‹ã—ã¦ãƒ†ã‚¹ãƒˆå¯èƒ½ãªè¨­è¨ˆï¼š

```
test/unit/
â”œâ”€â”€ TriggerManager.test.ts    â† ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ»çŠ¶æ…‹ç®¡ç†ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ ConfigManager.test.ts     â† è¨­å®šèª­ã¿è¾¼ã¿ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ DataMapper.test.ts        â† ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ»å‹å®‰å…¨æ€§ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ NotionApiClient.test.ts   â† APIé€šä¿¡ãƒ»ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ Validator.test.ts         â† æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ãƒ»ã‚¨ãƒ©ãƒ¼åˆ†é¡ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ Logger.test.ts            â† ãƒ­ã‚°ãƒ»ãƒã‚¹ã‚­ãƒ³ã‚°ãƒ»ã‚¿ã‚¤ãƒãƒ¼ãƒ†ã‚¹ãƒˆ
â””â”€â”€ Constants.test.ts         â† å®šæ•°ãƒ»è¨­å®šå€¤ãƒ†ã‚¹ãƒˆ
```

**ãƒ¢ãƒƒã‚¯åŒ–å¯¾è±¡ã®ä¾å­˜é–¢ä¿‚:**
- `SpreadsheetApp` (Google Apps Script API)
- `UrlFetchApp` (HTTPé€šä¿¡)
- `PropertiesService` (è¨­å®šä¿å­˜)
- `ScriptApp` (ãƒˆãƒªã‚¬ãƒ¼ç®¡ç†)
- `Session` (ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±)

#### **çµ±åˆãƒ†ã‚¹ãƒˆ** (`test/integration/`)
å®Ÿéš›ã®GASç’°å¢ƒã§ã®å‹•ä½œç¢ºèªï¼š

```
test/integration/
â”œâ”€â”€ basic-integration.test.ts      â† åŸºæœ¬æ©Ÿèƒ½çµ±åˆãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ end-to-end-basic.test.ts       â† E2Eãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ notion-api-basic.test.ts       â† Notion APIçµ±åˆãƒ†ã‚¹ãƒˆ
â””â”€â”€ spreadsheet-basic.test.ts      â† ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆçµ±åˆãƒ†ã‚¹ãƒˆ
```

**ç¾åœ¨ã®ãƒ†ã‚¹ãƒˆçŠ¶æ³**: 
- âœ… **178ãƒ†ã‚¹ãƒˆå…¨åˆæ ¼** (å®Ÿè¡Œæ™‚é–“: ~10.6ç§’)
- âœ… **Jest 30.0.5** + **TypeScript** ã«ã‚ˆã‚‹å‹å®‰å…¨ãªãƒ†ã‚¹ãƒˆ
- âœ… **ç¶™ç¶šçš„ãƒ†ã‚¹ãƒˆ**: `npm run test`

### ğŸ” ãƒ‡ãƒãƒƒã‚°æ”¯æ´æ©Ÿèƒ½

#### **è±Šå¯Œãªè¨ºæ–­é–¢æ•°** (`index.ts`)
æ‰‹å‹•å®Ÿè¡Œå¯èƒ½ãªãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½ï¼š

```typescript
// ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ è¨ºæ–­
globalThis.runDiagnostics              // ç·åˆè¨ºæ–­
globalThis.testConfiguration           // è¨­å®šè¨ºæ–­
globalThis.diagnoseProperties          // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¨ºæ–­
globalThis.diagnoseColumnMappingSheet  // ãƒãƒƒãƒ”ãƒ³ã‚°ã‚·ãƒ¼ãƒˆè¨ºæ–­

// ğŸ›ï¸ ãƒˆãƒªã‚¬ãƒ¼ç®¡ç†
globalThis.setupTriggers               // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ãƒˆãƒªã‚¬ãƒ¼è¨­å®š
globalThis.clearTriggers               // ãƒˆãƒªã‚¬ãƒ¼ã‚¯ãƒªã‚¢
globalThis.showTriggerStatus           // ãƒˆãƒªã‚¬ãƒ¼çŠ¶æ³è¡¨ç¤º

// ğŸ§ª æ‰‹å‹•ãƒ†ã‚¹ãƒˆ
globalThis.testOnEditManually          // onEditå‡¦ç†ãƒ†ã‚¹ãƒˆ
globalThis.testTriggerManager          // TriggerManagerå‹•ä½œãƒ†ã‚¹ãƒˆ
globalThis.testConnectionManually      // APIæ¥ç¶šãƒ†ã‚¹ãƒˆ
```

#### **é«˜æ©Ÿèƒ½ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ **
é–‹ç™ºãƒ»é‹ç”¨æ”¯æ´ã®ãƒ­ã‚°æ©Ÿèƒ½ï¼š

```typescript
// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬
Logger.startTimer('æ“ä½œå');
// ... å‡¦ç†
Logger.endTimer('æ“ä½œå');

// æ©Ÿå¯†æƒ…å ±ãƒã‚¹ã‚­ãƒ³ã‚°
Logger.info('API Tokenè¨­å®š', { 
  token: 'secret_abcd1234...' // â†’ 'secret_a***' ã«è‡ªå‹•ãƒã‚¹ã‚­ãƒ³ã‚°
});

// æ§‹é€ åŒ–ãƒ­ã‚°
Logger.error('å‡¦ç†ã‚¨ãƒ©ãƒ¼', {
  error: error,
  context: { rowNumber: 2, userId: 'user@example.com' }
});
```

### âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

#### **è¨­å®šã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥**
```typescript
export class ConfigManager {
  private static configCache: SystemConfig | null = null;
  private static cacheTimestamp = 0;
  private static readonly CACHE_DURATION = 5 * 60 * 1000; // 5åˆ†ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  
  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡å‘ä¸Šã«ã‚ˆã‚‹é«˜é€ŸåŒ–
}
```

#### **ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾å¿œ**
```typescript
class RateLimiter {
  private readonly minInterval = 334; // 3req/såˆ¶é™å¯¾å¿œ
  
  async waitForRateLimit(): Promise<void> {
    // Notion APIåˆ¶é™ã«æº–æ‹ ã—ãŸåŠ¹ç‡çš„ãªé€šä¿¡åˆ¶å¾¡
  }
}
```

### ğŸ”’ å‹å®‰å…¨æ€§ä¿è¨¼

#### **TypeScriptå³å¯†è¨­å®š**
```json
{
  "compilerOptions": {
    "strict": true,                           // å³å¯†å‹ãƒã‚§ãƒƒã‚¯
    "noImplicitAny": true,                   // anyå‹ç¦æ­¢
    "strictNullChecks": true,                // null/undefinedå³å¯†ãƒã‚§ãƒƒã‚¯
    "noUnusedLocals": true,                  // æœªä½¿ç”¨å¤‰æ•°æ¤œå‡º
    "noUnusedParameters": true               // æœªä½¿ç”¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¤œå‡º
  }
}
```

#### **å‹ã‚¬ãƒ¼ãƒ‰å®Ÿè£…**
```typescript
export class Validator {
  // å®Ÿè¡Œæ™‚å‹ãƒã‚§ãƒƒã‚¯ã«ã‚ˆã‚‹å®‰å…¨æ€§ç¢ºä¿
  static isValidColumnMapping(obj: any): obj is ColumnMapping {
    return typeof obj === 'object' &&
           typeof obj.spreadsheetColumn === 'string' &&
           typeof obj.notionPropertyName === 'string' &&
           // ... è©³ç´°ãªå‹ãƒã‚§ãƒƒã‚¯
  }
}
```

## å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### ğŸ“‹ **ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„**

#### **å‘½åè¦å‰‡**
- **ã‚¯ãƒ©ã‚¹å**: PascalCase (`TriggerManager`, `ConfigManager`)
- **ãƒ¡ã‚½ãƒƒãƒ‰å**: camelCase (`getConfig`, `processImport`)
- **å®šæ•°**: UPPER_SNAKE_CASE (`CONSTANTS.SHEETS.IMPORT_DATA`)
- **å‹å**: PascalCase (`SystemConfig`, `ColumnMapping`)

#### **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
```typescript
// âœ… æ¨å¥¨: å…·ä½“çš„ãªã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ä½¿ç”¨
throw new ConfigError('Database ID not found', originalError);

// âŒ éæ¨å¥¨: æ±ç”¨Errorä½¿ç”¨
throw new Error('Something went wrong');
```

#### **ãƒ­ã‚°å‡ºåŠ›**
```typescript
// âœ… æ¨å¥¨: æ§‹é€ åŒ–ãƒ­ã‚°
Logger.info('å‡¦ç†é–‹å§‹', { rowNumber, userId });

// âŒ éæ¨å¥¨: å˜ç´”ãªæ–‡å­—åˆ—
console.log('å‡¦ç†é–‹å§‹: è¡Œ' + rowNumber);
```

### ğŸš€ **ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæˆ¦ç•¥**

#### **ç’°å¢ƒåˆ¥è¨­å®š**
```bash
# é–‹ç™ºç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤
npm run deploy          # .clasp-dev.jsonä½¿ç”¨

# æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤  
npm run deploy:prod     # .clasp-prod.jsonä½¿ç”¨
```

#### **å“è³ªä¿è¨¼ãƒ—ãƒ­ã‚»ã‚¹**
```bash
# å®Œå…¨ãªå“è³ªãƒã‚§ãƒƒã‚¯
npm run lint           # ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯
npm run test           # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run build          # TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ»ãƒãƒ³ãƒ‰ãƒ«
```

å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è©³ç´°ãªå®Ÿè£…ä»•æ§˜ã¯ã€ãƒªãƒ³ã‚¯ã•ã‚ŒãŸå€‹åˆ¥è¨­è¨ˆæ›¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
